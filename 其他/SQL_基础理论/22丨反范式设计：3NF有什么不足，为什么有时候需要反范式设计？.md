# 22丨反范式设计：3NF有什么不足，为什么有时候需要反范式设计？

[TOC]

## 疑问

3NF 有什么不足？除了 3NF，我们为什么还需要 BCNF？

有了范式设计，为什么有时候需要进行反范式设计？

反范式设计适用的场景是什么？又可能存在哪些问题？

## BCNF（巴斯范式）

如何判断一张表的范式呢？我们需要根据范式的等级，从低到高来进行判断。

即便数据表符合 3NF 的要求，同样可能存在插入，更新和删除数据的异常情况。这种情况下该怎么解决呢？

人们在 3NF 的基础上进行了改进，提出了 BCNF，也叫做巴斯 - 科德范式，它在 3NF 的基础上消除了主属性对候选键的部分依赖或者传递依赖关系。

不存在主属性对于候选键的部分依赖或传递依赖，数据表的设计就符合 BCNF。

## 反范式设计

尽管围绕着数据表的设计有很多范式，但事实上，我们在设计数据表的时候却不一定要参照这些标准。

如果我们想对查询效率进行优化，有时候反范式优化也是一种优化思路。

## 反范式优化实验对比

在数据量大的情况下，查询效率会有显著的提升。

## 反范式存在的问题 & 适用场景

### 优缺点

优势：反范式可以通过空间换时间，提升查询的效率。

短板：在数据量小的情况下，反范式不能体现性能的优势，可能还会让数据库的设计更加复杂。

### 反范式优化适用于哪些场景呢？

当冗余信息有价值或者能大幅度提高查询效率的时候，我们就可以采取反范式的优化。

### 总结下数据仓库和数据库在使用上的区别

-   数据库设计的目的在于捕获数据，而数据仓库设计的目的在于分析数据；
-   数据库对数据的增删改实时性要求强，需要存储在线的用户数据，而数据仓库存储的一般是历史数据；
-   数据库设计需要尽量避免冗余，但为了提高查询效率也允许一定的冗余度，而数据仓库在设计上更偏向采用反范式设计。

## 总结

-   BCNF，它是基于 3NF 进行的改进。
-   设计范式越高阶，数据表就会越精细，数据的冗余度也就越少，在一定程度上可以让数据库在内部关联上更好地组织数据。
-   有时候我们也需要采用反范进行优化，通过空间来换取时间。
-   范式本身没有优劣之分，只有适用场景不同。
-   没有完美的设计，只有合适的设计，我们在数据表的设计中，还需要根据需求将范式和反范式混合使用。