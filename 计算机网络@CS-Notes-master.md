# 计算机网络

[TOC]

# 一，概述

## 网络的网络

网络把 主机主机连接起来，而 互联网 是把多种不同的网络连接起来，因此 互联网是网络的网络。

<div align="center"> <img src="pics/network-of-networks.gif" width="450"/> </div><br>

## ISP

互联网服务提供商 ISP 可以从互联网管理机构获得许多 IP 地址，同时拥有通信线路以及路由器等联网设备，个人或机构向 ISP 缴纳一定的费用就可以接入互联网。

<div align="center"> <img src="pics/46cec213-3048-4a80-aded-fdd577542801.jpg" width="500"/> </div><br>

目前的互联网是一种多层次的 ISP 结构，ISP 根据覆盖面积的大小 分为 第一层 ISP，区域 ISP 和 接入 ISP 。互联网交换点 IXP 允许两个 ISP 直接相连而不用经过第三个 ISP。

<div align="center"> <img src="pics/168e893c-e4a0-4ba4-b81f-9d993483abd0.jpg" width="500"/> </div><br>

## 主机之间的通信方式

-   客户-服务器（C/S）：客户是服务的请求放，服务器是服务的提供方
-   对等（P2P）：不区分客户和服务器

<div align="center"> <img src="pics/2ad244f5-939c-49fa-9385-69bc688677ab.jpg" width=""/> </div><br>

## 电路交换与分组交换

### 1，电路交换

电路交换用户电话通信系统，两个用户要通信之前建立一条专用的物理链路，并且在整个通信过程中始终占用该链路。由于通信的过程中不可能一直在传输线路，因此电路交换对线路的利用率很低，往往达不到10%。

### 2，分组交换

每个分组都有首部和尾部，包含了源地址和目的地址等控制信息，在同一传输线路上同时传输多个分组互相不会影响，因此，在同一条传输线路上允许同时传输多个分组，也就是说分组交换不需要占用传输线路。

在一个邮局通信系统中，邮局收到一份邮件之后，先存储下来，然后把相同目的地的邮件一起转发到下一个目的地，这个而过程就是存储转发过程，分组交换也使用存储转发过程。

## 时延

总时延 = 排队时延 + 处理时延 + 传输时延 + 传输时延

<div align="center"> <img src="pics/f71125b7-f7cb-4a96-9bf0-902bce9487f0.jpg" width="600"/> </div><br>

### 1，排队时延

分组在路由器的输入队列和输出队列中排队等待的时间，取决于网络当前的通信量。

### 2，处理时延

主机或路由器等收到分组时进行处理的所需要的时间，例如，分析首部，从分组中提取数据，进行差错校验或查找适当的路由器等。

### 3，传输时延

主机或路由器传输数据帧所需要的时间。

<div align="center"><img src="https://latex.codecogs.com/gif.latex?delay=\frac{l(bit)}{v(bit/s)}"/></div> <br>

其中 l 表示数据帧的长度，v 表示传输速率。

### 4，传播时延

电磁波在信道中传播所需要花费的时间。备注：电磁波传播的速度接近光速。

<div align="center"><img src="https://latex.codecogs.com/gif.latex?delay=\frac{l(m)}{v(m/s)}"/></div> <br>

其中 l 表示信道长度，v 表示电磁波在信道上的传播速度。

## 计算机网络体系结构

<div align="center"> <img src="pics/7fa66f48-bc42-4b98-93c2-56b20feaa990.png" width="500"/> </div><br>

1，五层协议

-   **应用层**：为特定应用程序提供数据传输服务，例如 HTTP，DNS 等。数据单位为 报文。
-   **传输层**：为进程提供通用数据传输服务。由于应用层协议很多，定义通用的传输层协议就可以支持不断增多的应用层协议。运输层包括两种协议：传输控制协议 TCP，提供面向连接，可靠的数据传输服务，数据单位为 报文段；用户数据报协议 UDP，提供无连接，尽最大女路的数据传输服务，数据单位为用户数据报。TCP 主要提供完整性服务，UDP 主要提供及时性服务。
-   **网络层**：为主机提供数据传输服务。而传输层协议是为了主机中的进程提供数据传输服务。网络层把传输层传递下拉ide报文段 或者  用户数据报 封装成分组。
-   **数据链路层**：网络层针对的还是主机之间的数据传输服务，而 主机之间可以有很多链路。链路层协议就是为 同意链路的主机提供数据传输服务。数据链路层 把 网络层传下来的分组封装成 帧。
-   **物理层**：考虑的是，怎样在传输媒体上传输数据比特流，而不是指具体的传输媒体。物理层的作用时尽可能陪你比传输媒体和通信手段的差异，使数据链路层感觉不到这些差异。

### 2，OSI

其中表示层和会话层用户如下：

表示层：数据压缩，加密 以及 数据描述，这使得应用程序不必关心在各台主机中数据内部格式不同的问题。

会话层：建立 及 管理 会话。

五层协议没有表示层 和 会话层，而是将这些功能留给应用程序开发者处理。

### 3，TCP / IP

它只有四层，相当于五层协议中数据链路层 和 物理层 合并为网络接口层。

TCP / IP 体系结构不严格遵循你  OSI 分层概念，应用层可能会直接使用  IP 层 或  网络接口层。

<div align="center"> <img src="pics/7048a730-a2d0-43d1-99ce-f774e4ef1b27.png" width="250"/> </div><br>

### 4，数据在各层之间的传递过程

在 向下的过程 中，需要 **添加** 下层协议所需要的 首部 或者 尾部，而在 向上的过程 中不断 **拆开** 首部和尾部。

路由器只有下面 三层协议，因为 路由器 位于 网络核心中，不需要 为进程或者 应用程序 提供服务，因此也就不需要传输层和应用层。

# 二，物理层

## 通信方式

根据信息在传输线上的传送方向，分为以下三种通信方式：

-   单工通信：单项传输
-   半双工通信：双向交替传输
-   全双工通信：双向同时传输

## 带通调制

模拟信号是连续的信号，数字信号是离散的信号。带通调制 把 数字信号 转换为 模拟信号。

<div align="center"> <img src="pics/c34f4503-f62c-4043-9dc6-3e03288657df.jpg" width="500"/> </div><br>

# 三，数据链路层

## 基本问题

### 1，封装成帧

将网络层传输下来的分组 添加 首部和尾部，用于标记 帧的开始和结束。

<div align="center"> <img src="pics/9c60793f-5e7f-453b-8413-35890c24abc4.png" width="500"/> </div><br>

### 2，透明传输 

**为什么有这？**

透明表示一个实际存在的事物看起来好像不存在一样。

帧使用首部和尾部进行定界，如果帧的数据部分含有和首部尾部相同的内容，那么帧的开始和结束位置就会被错的判定。需要在数据部分出现首部尾部相同的内容前面插入转义字符。如果数据部分出现转义字符，那么就在转义字符前面再加个转义字符。在接收端进行处理之后可以还原出原始数据。这个过程透明传输的内容是转义字符，用户察觉不到转义字符的存在。

<div align="center"> <img src="pics/839207f5-52fd-4516-9370-956dcdf2c2b5.png" width="600"/> </div><br>

### 3，差错检测

目前，数据链路层 广泛使用 循环冗余检测（CRC）来检查比特差错。

## 信道分类

### 1，广播信道

一对多通信，一个节点发送的数据能够被广播信道上所有的节点接收到。

所有的节点都在同一个广播信道上发送数据，因此需要有专门的控制方法进行协调，避免发生冲突（冲突也叫碰撞）。

主要有两种控制方法进行协调，一是 使用信道复用技术，二是 使用 CSMD/CD 协议。

### 2，点对点信道

一对一通信。

因为不会发生碰撞，因此也比较简单，使用 PPP协议进行控制。

## 信道复用技术

### 1，频分复用

频分复用的所有主机在相同的时间占用不同的频率带宽资源。

<div align="center"> <img src="pics/7e6cb8fc-1b82-4135-8b03-ebcfc546d94c.png" width="450"/> </div><br>

### 2，时分复用

时分复用的所有主机在不同的时间占用相同的频率贷款资源。

<div align="center"> <img src="pics/49e53613-46f8-4308-9ee5-c09d62367577.png" width="450"/> </div><br>

使用频分复用和时分复用进行通信，在通信的过程中会一直占用一部分信道资源。但是由于计算机数据的突发性质，通信过程没必要一直占用信道资源而不让出其他用户使用，因此这两种对信道的利用率都不高。

### 3，统计时分复用

是对 时分复用的一种改进，不固定每个用户在时分复用帧中的位置，只要有数据就集中起来组成统计时分复用帧 然后 发送。

<div align="center"> <img src="pics/e3360fa0-680e-486b-945f-09ff5d8612e4.png" width="450"/> </div><br>

### 4，波分复用

光的频分复用。由于光的频率很高，因此习惯上用 **波长** 而不是频率来表示所使用的光载波。

### 5，码分复用 - 不懂

缺

## CSMA/CD 协议

CSMA / CD 表示载波监听多点接入 / 碰撞检测

-   **多点接入**：说明这是总线型网络，许多主机以多点的方式连接到总线上。
-   **载波监听**：每个主机都必须不停地监听信道。在发送前，如果监听到信道正在使用，就必须等待。
-   **碰撞检测**：在发送中，如果监听到信道已有其他主机正在发送数据，就表示发生了碰撞。虽然每个主机在发送数据之前就已经监听到信道为 空闲，但是由于电磁波的传播时延的存在，还是有可能会发生碰撞。



















